# 02 타입 시스템

## 2.1 타입의 종류

'타입'은 자바스크립트에서 다루는 값의 **형태**에 대한 설명입니다.

예를 들어 다음과 같이 초깃값이 "Aretha"인 변수를 생성하는 경우, 타입스크립트는 singer 변수가 문자열 타입임을 유추할 수 있습니다.

```js
let singer = "Aretha";
```

타입스크립트의 가장 기본적인 타입은 일곱 가지 기본 원시 타입과 동일하며, 다음 값을 일곱 가지 기본 원시 타입 중 하나로 간주합니다.

```js
-null; // null
-undefined; // undefined
-"Louise"; // string
-1337; // number
-1337n; // bigint
-Symbol("Franklin"); //symbol
```

### 2.1.1 타입 시스템

타입 시스템은 프로그래밍 언어가 타입을 이해하는 방법에 대한 규칙들로 다음과 같이 작동합니다.

1. 코드를 읽고 존재하는 모든 타입과 값을 이해합니다.
2. 각 값이 초기 선언에서 가질 수 있는 타입을 확인합니다.
3. 각 값이 추후 코드에서 어떻게 사용될 수 있는지 모든 방법을 확인합니다.
4. 값의 사용법이 타입과 일치하지 않으면 사용자에게 오류를 표시합니다.

다음은 타입스크립트가 멤버 속성을 함수로 잘못 호출해 타입 오류가 발생하는 코드입니다.

```js
let firstName = "Whitney";
firstName.length();
// ~~~~~
// Error: This expression is not callable
//  Type "Number" has no call signatures
```

또한 타입스크립트는 다음과 같은 순서로 오류를 표시합니다.

1. 코드를 읽고 firstName이라는 변수를 이해합니다.
2. 초깃값이 "Whitney"이므로 firstName이 string 타입이라고 결론짓습니다.
3. firstName의 .length 멤버를 함수처럼 호출하는 코드를 확인합니다.
4. string의 .length 멤버는 함수가 아닌 숫자라는 오류를 표시합니다. **즉, 함수처럼 호출할 수 없습니다.**

### 2.1.2 오류 종류

타입스크립트 작성 시 자주 접하는 오류 두 가지가 있습니다.

- 구문 오류: 타입스크립트가 자바스크립트로 변환되는 것을 차단한 경우
- 타입 오류: 타입 검사기에 따라 일치하지 않는 것이 감지된 경우

#### 구문 오류

구문 오류는 타입스크립트가 코드를 이해할 수 없는 잘못된 구문을 감지할 때 발생합니다. 이는 타입스크립트가 타입스크립트 파일에서 자바스크립트 파일을 올바르게 생성할 수 없도록 차단합니다. 물론 타입스크립트 코드를 자바스크립트를 변환하는 데 사용하는 도구와 설정에 따라 자바스크립트 코드를 얻을 수도 있습니다.

#### 타입 오류

타입 오류는 타입스크립트의 타입 검사기가 프로그램의 타입에서 오류를 감지했을 때 발생합니다. 오류가 발생했다고 타입스크립트 구문이 자바스크립트로 변환되는 것을 차단하지는 않습니다. 하지만 코드가 실행되면 무언가 충돌하거나 예기치 않게 작동할 수 있음을 나타납니다.

타입스크립트는 타입 오류가 있음에도 불구하고 자바스크립트 코드를 출력할 수 있지만, 출력된자바스크립트 코드가 원하는 대로 실행되지 않을 가능성이 있다는 신호를 타입 오류로 알려줍니다. 따라서 자바스크립트 실행 전, 타입 오류를 확인하고 문제를 먼저 해결하는 것이 가장 좋습니다.

## 2.2 할당 가능성

타입스크립트는 변수의 초깃값을 읽고 해당 변수가 허용되는 타입을 결정합니다. 나중에 해당 변수에 새로운 값이 할당되면, 새롭게 할당된 값의 타입이 변수의 타입과 동일한지 확인합니다.

타입스크립트 변수에 동일한 타입의 다른 값이 할당될 때는 문제가 없지만, 변수에 다른 타입의 값이 할당되면 타입 오류가 발생합니다.

타입스크립트에서 함수 호출이나 변수에 값을 제공할 수 있는지 여부를 확인하는 것을 **할당 가능성** 이라고 합니다. 즉, 전달된 값이 예상된 타입으로 할당 가능한지 여부를 확인합니다.

### 2.2.1 할당 가능성 오류 이해하기

'Type..is not assignable to type...' 형태의 오류는 타입스크립트 코드를 작성할 때 만나게 되는 가장 일반적인 오류 중 하나입니다.

이 오류 메시지 중 첫 번째로 언급된 type은 코드에서 변수에 할당하려고 시도하는 값입니다. 두 번째 type은 첫 번째 타입, 즉 값이 할당되는 변수입니다.

## 2.3 타입 애너테이션

변수에 타입스크립트가 읽어야 할 초깃값이 없는 경우에는 타입스크립트는 나중에 사용할 변수의 초기 타입을 파악하려고 시도하지 않습니다. 그리고 기본적으로 변수를 암묵적인 any 타입으로 간주합니다.

초기 타입을 유추할 수 없는 변수는 **진화하는 any**라고 부릅니다. 특정 타입을 강제하는 대신 새로운 값이 할당될 때마다 변수 타입에 대한 이해를 발전시킵니다.

타입스크립트는 초깃값을 할당하지 않고도 변수의 타입을 선언할 수 있는 구문인 **타입 에너테이션**을 제공합니다. 타입 애너테이션은 변수 이름 뒤어 배치되며 콜론(:)과 타입 이름을 차례대로 기재합니다.

이러한 타입 애너테이션은 타입스크립트에만 존재하며 런타임 코드에 영향을 주지도 않고, 유효한 자바스크립트 구문도 아닙니다.

### 2.3.1 불필요한 타입 애너테이션

타입 애너테이션은 타입스크립트가 자체적으로 수집할 수 없는 정보를 타입스크립트에 제공할 수 있습니다. 타입을 즉시 유추할 수 있는 변수에도 타입 에너테이션을 사용할 수 있습니다. 하지만 타입스크립트가 아직 알지 못하는 것은 알려주지 못합니다.

다음 코드에서 string 타입 애너테이션은 중복입니다. 타입스크립트가 이미 firstName이 string 타입임을 유추할 수 있기 때문입니다.

```js
let firstName: string = "Tina"; // 타입 시스템은 변경되지 않음
```

많은 개발자들은 아무것도 변하지 않는 변수에는 번거롭기에 타입 애너테이션을 추가하지 않기를 선호합니다. 하지만 코드를 명확하게 문서화하거나 실수로 변수 타입이 변경되지 않도록 타입스크립트를 보호하기 위해 변수에 명시적으로 타입 애너테이션을 포함하는 것이 경우에 따라 유용할 수 있습니다.

## 2.4 타입 형태

타입스크립트는 변수에 할당된 값이 원래 타입과 일치하는지 확인하는 것 이상을 수행합니다. 타입스크립트는 객체에 어떤 멤버 속성이 존재하는지 알고 있습니다. 또한 타입스크립트는 객체의 형태에 대한 이해를 바탕으로 할당 가능성뿐만 아니라 객체 사용과 관련된 문제도 알려줍니다.

### 2.4.1 모듈

최근까지 자바스크립트는 서로 다른 파일에 작성된 코드를 공유를 제공하지 않았지만, ECMA스크립트 2015에는 파일 간에 가져오고 내보내는 구문을 표준화하기 위해 ECMA스크립트 모듈이 추가되었습니다.

ECMA스크립트 사양과 일치시키기 위해 이 책에서는 다음 명명법을 사용합니다.

- 모듈: export 또는 import가 있는 파일
- 스크립트: 모듈이 아닌 모든 파일

타입스크립트는 최신 모듈 파일을 기존 파일과 함께 실행할 수 있습니다. 모듈 파일에 선언된 모든 것은 export 문에서 내보내지 않는 한 모듈 파일에서만 사용가능합니다. 한 모듈에서 다른 파일로 선언된 변수와 동일한 이름으로 선언된 변수는 다른 파일의 변수를 가져오지 않는 한 이름 충돌로 간주하지 않습니다.

그러나 파일이 스크립트면 타입스크립트는 해당 파일을 전역 스코프로 간주하므로 모든 스크립트가 파일의 내용에 접근할 수 있습니다. 즉, 스크립트 파일에 선언된 변수는 다른 스크립트 파일에 선언된 변수와 동일한 이름을 가질 수 없습니다.

타입스크립트 파일에 Cannot redeclare... 라는 오류가 표시되면 파일에 아직 export 또는 import 문을 추가하지 않았기 때문일 수 있습니다. ECMA 스크립트 사양에 따라 export 또는 import 문 없이 파일을 모듈로 만들어야 한다면 파일의 아무 곳에나 export{};를 추가해 강제로 모듈이 되도록 만듭니다.

```js
const shared = "Cher"; // OK

export {};
```

## 2.5 마치며

이 장에서는 타입스크립트의 타입 시스템이 어떻게 작동하는지 살펴봤습니다.

- '타입'은 무엇인지 알아보고 타입스크립트가 인식하는 원시 타입 이해하기
- '타입 시스템'은 무엇인지 알아보고 타입스크립트의 타입 시스템이 코드를 이해하는 방법 살펴보기
- 타입 오류와 구문 오류의 차이점
- 유츄된 변수 타입과 변수 할당 가능성
- 타입 애너테이션으로 변수 타입을 명시적으로 선언하고 any 타입의 진화 방지하기
- 타입 형태에서 객체 멤버 확인하기
- 스크립트 파일과는 다른 ECMA스크립트 모듈 파일의 선언 스코프
